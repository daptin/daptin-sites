(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["1761f014"],{"4d76":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{attrs:{view:"hhh lpR fFf"}},[a("q-page-container",[a("q-drawer",{attrs:{width:300,side:"left",bordered:""},model:{value:t.left,callback:function(e){t.left=e},expression:"left"}},[a("q-list",[t._l(t.appLayout.tabs,function(e,n){return[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,attrs:{clickable:""},on:{click:function(a){return t.setTab(e)}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:e.icon}})],1),a("q-item-section",[t._v("\n              "+t._s(e.label)+"\n            ")])],1),e.separator?a("q-separator",{key:"sep_"+n}):t._e()]}),a("q-item",[a("q-btn",{staticStyle:{width:"100%"},attrs:{label:"Add tab"},on:{click:function(e){t.newTabNameDialog=!0}}})],1)],2)],1),a("q-page",t._l(t.screens,function(e,n){return a("div",{key:n,staticClass:"col-12"},[a("q-bar",[t._v("\n          Layout Â \n          "),a("q-select",{attrs:{borderless:"",options:Object.keys(t.appLayout.layoutConfiguration)},model:{value:e.layoutName,callback:function(a){t.$set(e,"layoutName",a)},expression:"screen.layoutName"}}),a("q-space"),a("q-btn",{attrs:{color:"green",label:"Update"},on:{click:function(a){return t.saveTemplate(e.template,n)}}})],1),a("div",{staticClass:"row"},[a("q-icon",{staticStyle:{"font-size":"4rem"},attrs:{name:t.tab.icon}}),a("q-input",{model:{value:t.tab.label,callback:function(e){t.$set(t.tab,"label",e)},expression:"tab.label"}}),a("q-select",{attrs:{filled:"",size:"sm",options:["list","single"]},on:{input:function(a){return t.updateScreenType(e)}},model:{value:e.layout.type,callback:function(a){t.$set(e.layout,"type",a)},expression:"screen.layout.type"}}),a("q-select",{attrs:{filled:"","map-options":"","emit-value":"",size:"sm","option-value":"table_name","option-label":"table_name",options:t.models},model:{value:e.layout.item,callback:function(a){t.$set(e.layout,"item",a)},expression:"screen.layout.item"}}),a("q-select",{attrs:{filled:"","use-input":"","use-chips":"","new-value-mode":"add-unique","map-options":"","emit-value":"",options:t.appLayout.templates,"option-label":"name","option-value":"name"},on:{"new-value":t.newTemplate,input:function(a){return t.updateScreenTemplate(e,n)}},model:{value:e.layout.template,callback:function(a){t.$set(e.layout,"template",a)},expression:"screen.layout.template"}})],1),a("div",{staticClass:"row",staticStyle:{height:"450px"}},[a("div",{staticClass:"col-3"},[a("iframe",{staticClass:"flower preview-frame",staticStyle:{width:"100%",height:"450px","z-index":"-1"},attrs:{src:e.path}})]),a("div",{staticClass:"col-9",staticStyle:{height:"100%"}},[a("editor",{attrs:{width:"100%",height:"450px",theme:"monokai",lang:"html"},on:{input:function(a){return t.updateTemplate(e.template)}},model:{value:e.template.template,callback:function(a){t.$set(e.template,"template",a)},expression:"screen.template.template"}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-3",staticStyle:{"overflow-x":"hidden","overflow-y":"scroll"}},[a("q-bar",[t._v("\n              Mapping\n            ")]),a("table",{staticStyle:{width:"100%"}},[a("tbody",t._l(Object.keys(e.layout.transform.item),function(n){return a("tr",{key:n},[a("td",{staticStyle:{width:"40%"}},[t._v("\n                  "+t._s(n)+"\n                ")]),a("td",{staticStyle:{padding:"0"}},[a("v-select",{attrs:{reduce:function(t){return t.ColumnName},options:e.table.schema.Columns,value:"ColumnName",label:"ColumnName"},model:{value:e.layout.transform.item[n],callback:function(a){t.$set(e.layout.transform.item,n,a)},expression:"screen.layout.transform.item[key]"}})],1),a("td")])}),0)])],1),a("div",{staticClass:"col-4"},[a("q-bar",[t._v("CSS Style")]),a("editor",{staticStyle:{height:"100%"},attrs:{lang:"css",theme:"monokai"},model:{value:e.template.style,callback:function(a){t.$set(e.template,"style",a)},expression:"screen.template.style"}},[t._v("css")])],1),a("div",{staticClass:"col-5"},[a("q-bar",[t._v("Actions")]),a("table",{staticClass:"ui celled table",staticStyle:{"margin-top":"0"}},[a("thead",[a("tr",[a("th",[t._v("Action")]),a("th",[t._v("Type")]),a("th",[t._v("To")])])]),a("tbody",t._l(Object.keys(e.layout.actions),function(n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",[t._v(t._s(e.layout.actions[n].type))]),a("td",[a("v-select",{staticStyle:{"min-width":"200px"},attrs:{options:Object.keys(t.appLayout.layoutConfiguration).map(function(e){return"single"==t.appLayout.layoutConfiguration[e].type?"/"+e+"/{{reference_id}}":"/"+e})},model:{value:e.layout.actions[n].path,callback:function(a){t.$set(e.layout.actions[n],"path",a)},expression:"screen.layout.actions[action].path"}})],1)])}),0)])],1)])],1)}),0)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.newTabNameDialog,callback:function(e){t.newTabNameDialog=e},expression:"newTabNameDialog"}},[a("q-card",{staticStyle:{"min-width":"400px"}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("New tab")])]),a("q-card-section",[a("q-input",{attrs:{placeholder:"New Tab Label"},model:{value:t.newTabName,callback:function(e){t.newTabName=e},expression:"newTabName"}}),a("q-select",{attrs:{"use-input":"","use-chips":"",size:"sm",options:t.layouts,label:"Layout"},on:{"new-value":t.newLayout},model:{value:t.newTabLayout,callback:function(e){t.newTabLayout=e},expression:"newTabLayout"}}),a("q-select",{attrs:{"option-label":"id","option-value":"id",options:t.icons,label:"Icon"},model:{value:t.newTabIcon,callback:function(e){t.newTabIcon=e},expression:"newTabIcon"}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Add"},on:{click:function(e){return t.addTab(t.newTabName,t.newTabIcon,t.newTabLayout)}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.newScreenNameDialog,callback:function(e){t.newScreenNameDialog=e},expression:"newScreenNameDialog"}},[a("q-card",{staticStyle:{"min-width":"400px"}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("Tab name")])]),a("q-card-section",[a("q-input",{attrs:{dense:"",autofocus:""},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.prompt=!1}},model:{value:t.newTabName,callback:function(e){t.newTabName=e},expression:"newTabName"}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Add"},on:{click:function(e){return t.addTab(t.newTabName)}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.newActionNameDialog,callback:function(e){t.newActionNameDialog=e},expression:"newActionNameDialog"}},[a("q-card",{staticStyle:{"min-width":"400px"}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("Tab name")])]),a("q-card-section",[a("q-input",{attrs:{dense:"",autofocus:""},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.prompt=!1}},model:{value:t.newTabName,callback:function(e){t.newTabName=e},expression:"newTabName"}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Add"},on:{click:function(e){return t.addTab(t.newTabName)}}})],1)],1)],1)],1)},o=[],l=(a("28a5"),a("b2cb")),i=a.n(l),s=(a("456d"),a("7f7f"),a("ac6a"),a("cadf"),a("06db"),a("5df3"),a("f400"),a("b178")),c=a("2f62"),r=(a("9dbb"),{watch:{"appLayout.templates":function(){console.log("templates changed");for(var t=this.appLayout.templates,e=new Map,a=0;a<t.length;a++){var n=t[a];e.set(n.name,n)}this.templateMap=e;for(a=0;a<this.screens.length;a++)this.screens[a].template=this.templateMap.get(this.screens[a].layout.template)},"appLayout.layoutConfiguration":function(){console.log("layout config changed"),this.layouts=Object.keys(this.appLayout.layoutConfiguration)}},computed:i()({},Object(c["c"])(["appLayout","user","layout","models","icons"])),name:"MyLayout",data:function(){return{flowers:[],tab:null,left:this.$q.platform.is.desktop,screens:[],newTabNameDialog:!1,newScreenNameDialog:!1,newActionNameDialog:!1,newTabLayout:"",newTabTemplate:"",layouts:[],newTabItem:"user_account",newTabName:null,newTabIcon:null,newScreenName:"",newActionName:"",templateMap:{},data:null}},methods:i()({newLayout:function(t,e){if(console.log("add new layout",t),!this.appLayout.layoutConfiguration[t]){var a=t+"_template";this.newTemplate(a,function(){}),this.appLayout.layoutConfiguration[t]={type:"list",item:"user_account",transform:{list:"data",item:{}},template:a},this.layouts.push(t)}e(t)},newTemplate:function(t,e){console.log("new template name",arguments),this.createTemplate({name:t}),e(t,"add-unique")},updateScreenType:function(t){console.log("update screen type",t);var e=t.path,a=null;if(a="list"==t.layout.type?"/"+t.layoutName:"/"+t.layoutName+"/{{reference_id}}",a){for(var n=0;n<this.appLayout.tabs.length;n++)this.appLayout.tabs[n].path==e&&(this.appLayout.tabs[n].path=a);this.saveConfig()}},updateScreenTemplate:function(t,e){t.layout.template&&(t.template=this.templateMap.get(t.layout.template),console.log("updated screen template ",t),this.saveConfig(),document.getElementsByClassName("preview-frame")[e].src=document.getElementsByClassName("preview-frame")[e].src+"")},addTab:function(t,e,a){this.newTabNameDialog=!1;var n=this.appLayout.layoutConfiguration[a];"list"==n.type?this.addNewTab({label:t,icon:e.id,path:"/"+a+"/template"}):this.addNewTab({label:t,icon:e.id,path:"/"+a+"/template/{{reference_id}}"})},saveTemplate:function(t,e){console.log("update template",arguments),this.setTemplate(t),this.saveConfig(),t.showSave=!1,document.getElementsByClassName("preview-frame")[e].src=document.getElementsByClassName("preview-frame")[e].src+""},updateTemplate:function(t){console.log("update template",arguments),t.showSave=!0},openURL:s["c"]},Object(c["b"])(["setLayout","getData","saveConfig","setTemplate","addNewTab","createTemplate"]),{setTab:function(t){console.log("load page",t),this.screens=[],this.tab=t,this.pushScreens(t.path)},getWorldSchema:function(t){console.log("get world schema for",t);for(var e=0;e<this.models.length;e++)if(this.models[e].table_name==t)return this.models[e];return null},pushScreens:function(t){var e=this;console.log("push screens from ",t);var a=t.split("/")[1];console.log("push ");var n=this.appLayout.layoutConfiguration[a];if(console.log("push layout actions",n),this.screens.push({parent:"Top Level",path:t,name:t,template:this.templateMap.get(n.template),layout:n,layoutName:a,actionName:"TabItemClick",table:this.getWorldSchema(n.item)}),n.actions){Object.keys(n.actions);this.getData({layout:n,params:{}}).then(function(t){console.log("loaded data for layout",t);e.data=t})}}}),mounted:function(){this.user||this.$router.push("/");for(var t=this.appLayout.templates,e=new Map,a=0;a<t.length;a++){var n=t[a];e.set(n.name,n)}this.templateMap=e,this.layouts=Object.keys(this.appLayout.layoutConfiguration)}}),u=r,p=a("2877"),m=Object(p["a"])(u,n,o,!1,null,null,null);e["default"]=m.exports},b39a:function(t,e,a){var n=a("d3f4");t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},c26b:function(t,e,a){"use strict";var n=a("86cc").f,o=a("2aeb"),l=a("dcbc"),i=a("9b43"),s=a("f605"),c=a("4a59"),r=a("01f9"),u=a("d53b"),p=a("7a56"),m=a("9e1e"),d=a("67ab").fastKey,f=a("b39a"),y=m?"_s":"size",b=function(t,e){var a,n=d(e);if("F"!==n)return t._i[n];for(a=t._f;a;a=a.n)if(a.k==e)return a};t.exports={getConstructor:function(t,e,a,r){var u=t(function(t,n){s(t,u,e,"_i"),t._t=e,t._i=o(null),t._f=void 0,t._l=void 0,t[y]=0,void 0!=n&&c(n,a,t[r],t)});return l(u.prototype,{clear:function(){for(var t=f(this,e),a=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete a[n.i];t._f=t._l=void 0,t[y]=0},delete:function(t){var a=f(this,e),n=b(a,t);if(n){var o=n.n,l=n.p;delete a._i[n.i],n.r=!0,l&&(l.n=o),o&&(o.p=l),a._f==n&&(a._f=o),a._l==n&&(a._l=l),a[y]--}return!!n},forEach:function(t){f(this,e);var a,n=i(t,arguments.length>1?arguments[1]:void 0,3);while(a=a?a.n:this._f){n(a.v,a.k,this);while(a&&a.r)a=a.p}},has:function(t){return!!b(f(this,e),t)}}),m&&n(u.prototype,"size",{get:function(){return f(this,e)[y]}}),u},def:function(t,e,a){var n,o,l=b(t,e);return l?l.v=a:(t._l=l={i:o=d(e,!0),k:e,v:a,p:n=t._l,n:void 0,r:!1},t._f||(t._f=l),n&&(n.n=l),t[y]++,"F"!==o&&(t._i[o]=l)),t},getEntry:b,setStrong:function(t,e,a){r(t,e,function(t,a){this._t=f(t,e),this._k=a,this._l=void 0},function(){var t=this,e=t._k,a=t._l;while(a&&a.r)a=a.p;return t._t&&(t._l=a=a?a.n:t._t._f)?u(0,"keys"==e?a.k:"values"==e?a.v:[a.k,a.v]):(t._t=void 0,u(1))},a?"entries":"values",!a,!0),p(e)}}},e0b8:function(t,e,a){"use strict";var n=a("7726"),o=a("5ca1"),l=a("2aba"),i=a("dcbc"),s=a("67ab"),c=a("4a59"),r=a("f605"),u=a("d3f4"),p=a("79e5"),m=a("5cc5"),d=a("7f20"),f=a("5dbc");t.exports=function(t,e,a,y,b,h){var v=n[t],w=v,g=b?"set":"add",_=w&&w.prototype,T={},k=function(t){var e=_[t];l(_,t,"delete"==t?function(t){return!(h&&!u(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(h&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return h&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,a){return e.call(this,0===t?0:t,a),this})};if("function"==typeof w&&(h||_.forEach&&!p(function(){(new w).entries().next()}))){var N=new w,q=N[g](h?{}:-0,1)!=N,C=p(function(){N.has(1)}),x=m(function(t){new w(t)}),S=!h&&p(function(){var t=new w,e=5;while(e--)t[g](e,e);return!t.has(-0)});x||(w=e(function(e,a){r(e,w,t);var n=f(new v,e,w);return void 0!=a&&c(a,b,n[g],n),n}),w.prototype=_,_.constructor=w),(C||S)&&(k("delete"),k("has"),b&&k("get")),(S||q)&&k(g),h&&_.clear&&delete _.clear}else w=y.getConstructor(e,t,b,g),i(w.prototype,a),s.NEED=!0;return d(w,t),T[t]=w,o(o.G+o.W+o.F*(w!=v),T),h||y.setStrong(w,t,b),w}},f400:function(t,e,a){"use strict";var n=a("c26b"),o=a("b39a"),l="Map";t.exports=a("e0b8")(l,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(o(this,l),t);return e&&e.v},set:function(t,e){return n.def(o(this,l),0===t?0:t,e)}},n,!0)}}]);